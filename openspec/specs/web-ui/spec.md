# web-ui Specification

## Purpose
TBD - created by archiving change add-web-comparison-interface. Update Purpose after archive.
## Requirements
### Requirement: 文件上传界面
系统 SHALL 提供一个 Web 页面,允许用户上传两个 Excel 文件(单机库和全国库)。

#### Scenario: 用户访问主页
- **WHEN** 用户访问应用根路径 `/`
- **THEN** 系统显示包含两个文件上传框的表单
- **AND** 表单包含"单机党员花名册"和"全国党员花名册"两个独立的上传区域
- **AND** "开始比对"按钮初始状态为禁用

#### Scenario: 用户上传第一个文件
- **WHEN** 用户选择并上传单机库文件
- **THEN** 系统自动触发模板校验
- **AND** 在上传框旁显示校验状态(✓ 通过 或 ✗ 失败 + 错误详情)

#### Scenario: 两个文件均通过校验
- **WHEN** 单机库和全国库文件均上传且校验通过
- **THEN** "开始比对"按钮变为可用状态
- **AND** 按钮样式改变以提示用户可点击

### Requirement: 比对结果展示
系统 SHALL 在网页上直接展示比对结果,包括多出人员、缺少人员和字段差异。

#### Scenario: 比对成功并显示结果
- **WHEN** 用户点击"开始比对"按钮
- **THEN** 系统执行比对逻辑并跳转到结果页面 `/result`
- **AND** 结果页面包含以下可展开/折叠的表格区域:
  - "单机多出人员"表格
  - "全国多出人员"表格
  - 每个字段的差异表格(姓名差异、性别差异等)

#### Scenario: 结果表格显示详细信息
- **WHEN** 用户查看"单机多出人员"表格
- **THEN** 表格显示所有仅在单机库存在的党员完整信息
- **AND** 包含序号、姓名、身份证号、性别、民族、入党时间等所有字段

#### Scenario: 字段差异表格显示对比
- **WHEN** 用户查看"姓名差异"表格
- **THEN** 表格包含四列:姓名、身份证号、单机表信息、全国表信息
- **AND** 仅显示身份证号相同但姓名字段不同的记录

### Requirement: 结果下载功能
系统 SHALL 提供下载按钮,允许用户下载包含所有比对结果的 Excel 文件。

#### Scenario: 用户下载比对结果
- **WHEN** 用户在结果页面点击"下载比对结果"按钮
- **THEN** 系统生成包含所有比对结果的 Excel 文件
- **AND** 文件名格式为 `比对结果_<时间戳>.xlsx`
- **AND** Excel 文件包含多个 Sheet,每个 Sheet 对应一个比对结果部分
- **AND** 浏览器自动开始下载该文件

### Requirement: 加载状态提示
系统 SHALL 在执行耗时操作时显示加载动画或进度提示。

#### Scenario: 比对过程显示加载动画
- **WHEN** 用户点击"开始比对"按钮
- **THEN** 页面显示加载动画或"正在比对中..."提示
- **AND** 禁用"开始比对"按钮防止重复提交
- **AND** 比对完成后自动跳转到结果页面

### Requirement: 错误提示
系统 SHALL 在操作失败时向用户显示清晰的错误信息。

#### Scenario: 文件上传失败
- **WHEN** 用户上传的文件超过 10MB
- **THEN** 系统显示错误提示:"文件大小超过限制(最大 10MB)"
- **AND** 清空该上传框的内容

#### Scenario: 模板校验失败
- **WHEN** 上传的单机库文件表头不匹配模板
- **THEN** 系统显示错误提示:"模板格式不正确"
- **AND** 列出缺失或多余的列名
- **AND** "开始比对"按钮保持禁用状态

